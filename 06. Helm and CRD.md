### Helm
1. Which command is used to search for a wordpress helm chart package from the Artifact Hub?
   option1: helm find hub wordpress
   option2: helm search hub wordpress

    controlplane ~ ‚ûú  helm search hub wordpress
    URL                                                     CHART VERSION   APP VERSION              DESCRIPTION                                       
    https://artifacthub.io/packages/helm/wordpress-...      1.0.2           1.0.0                    A Helm chart for deploying Wordpress+Mariadb st...
    https://artifacthub.io/packages/helm/kube-wordp...      0.1.0           1.1                      this is my wordpress package                      
    https://artifacthub.io/packages/helm/bitnami/wo...      24.1.11         6.7.2                    WordPress is the world's most popular blogging ...
    https://artifacthub.io/packages/helm/bitnami-ak...      15.2.13         6.1.0                    WordPress is the world's most popular blogging ...
    ...

   Answer: option2

2.  Add a bitnami helm chart repository in the controlplane node.
    name - bitnami
    chart repo name - https://charts.bitnami.com/bitnami
    
    Hint: Run helm help and search for helm repo command to add chart repository.

    controlplane ~ ‚ûú  helm repo -h
    ...
    Available Commands:
    add         add a chart repository
    index       generate an index file given a directory containing packaged charts
    list        list chart repositories
    remove      remove one or more chart repositories
    update      update information of available charts locally from chart repositories
    ...

    controlplane ~ ‚ûú  helm repo add -h
    add a chart repository

    Usage:
    helm repo add [NAME] [URL] [flags]
    ...
    
    controlplane ~ ‚ûú  helm repo add bitnami https://charts.bitnami.com/bitnami controlplane
    Error: "helm repo add" requires 2 arguments

    Usage:  helm repo add [NAME] [URL] [flags]

    controlplane ~ ‚úñ helm repo add bitnami https://charts.bitnami.com/bitnami
    "bitnami" has been added to your repositories


    Which command is used to search for the joomla package from the added repository?
        option1: helm search repo joomla
        option2: helm find joomla
        option3: helm get repo joomla

    controlplane ~ ‚ûú  helm search repo joomla
    NAME            CHART VERSION   APP VERSION     DESCRIPTION                                       
    bitnami/joomla  20.0.4          5.1.2           DEPRECATED Joomla! is an award winning open sou...

    Answer: option1 


    What is the app version of joomla in the bitnami helm repository?
    Hint: Run : helm search repo joomla and look at the APP VERSION column.

    controlplane ~ ‚ûú  helm search repo joomla
    NAME            CHART VERSION   APP VERSION     DESCRIPTION                                       
    bitnami/joomla  20.0.4          **5.1.2**       DEPRECATED Joomla! is an award winning open sou...

    Answer: 5.1.2


    Which chart version can you see for the joomla package in the bitnami helm repo?

    Carry On:

    CHART VERSION
    20.0.4

    Answer: 20.0.4

3.  How many helm repositories are added in the controlplane node?

    controlplane ~ ‚ûú  helm repo list -h
    list chart repositories

    Usage:
    helm repo list [flags]
    ...


    controlplane ~ ‚ûú  helm repo list
    NAME            URL                                                 
    bitnami         https://charts.bitnami.com/bitnami                  
    puppet          https://puppetlabs.github.io/puppetserver-helm-chart
    hashicorp       https://helm.releases.hashicorp.com                 

    Answer: 3 repos


4.  Install drupal helm chart from the bitnami repository.
    Release name should be bravo.
    Chart name should be bitnami/drupal.
    Note: Ignore the state of the application now.

    controlplane ~ ‚ûú  helm install ~~drupal~~ bravo bitnami/drupal
    Error: INSTALLATION FAILED: expected at most two arguments, unexpected arguments: oci://us-central1-docker.pkg.dev/kk-lab-prod/helm-charts/bitnami/drupal

    controlplane ~ ‚úñ helm install bravo bitnami/drupal
    Pulled: us-central1-docker.pkg.dev/kk-lab-prod/helm-charts/bitnami/drupal:21.1.3
    Digest: sha256:1986543cf00e9b7ec2d03c97e5d11588efd6419767036b3555afd8b9c3203f79
    NAME: bravo
    LAST DEPLOYED: Tue Feb 18 21:59:13 2025
    NAMESPACE: default
    STATUS: deployed
    REVISION: 1
    TEST SUITE: None
    NOTES:
    CHART NAME: drupal
    CHART VERSION: 21.1.3
    APP VERSION: 11.1.2

    Verify: use helm list command to verify if installed

    controlplane ~ ‚ûú  helm list
    NAME    NAMESPACE       REVISION        UPDATED                                 STATUS          CHART         APP VERSION
    bravo   default         1               2025-02-18 21:59:13.226818143 +0000 UTC deployed        drupal-21.1.3 11.1.2     

    
    Which command is used to list packages installed using helm?
        option1: helm package
        option2: helm list

    controlplane ~ ‚ûú  helm list
    NAME    NAMESPACE       REVISION        UPDATED                                 STATUS          CHART           APP VERSION
    bravo   default         1               2025-02-18 21:59:13.226818143 +0000 UTC deployed        drupal-21.1.3   11.1.2     

    Answer: option2
    
    
    Uninstall the drupal helm package which we installed earlier.

    controlplane ~ ‚ûú  helm uninstall -h
    ...
    Usage:
    helm uninstall RELEASE_NAME [...] [flags]
    ...

    controlplane ~ ‚ûú  helm uninstall bravo
    release "bravo" uninstalled


5.  Download the bitnami apache package under the /root directory.
    Note: Do not install the package. Just download it.

    Hint: Run the command : helm pull --untar  bitnami/apache
    (--untar: if set to true, will untar the chart after downloading it)

    controlplane ~ ‚úñ helm pull --untar bitnami/apache
    Pulled: us-central1-docker.pkg.dev/kk-lab-prod/helm-charts/bitnami/apache:11.3.2
    Digest: sha256:1bd45c97bb7a0000534e3abc5797143661e34ea7165aa33068853c567e6df9f2

6.  Inspect the file values.yaml and make changes so that 2 replicas of the webserver are running and the http is exposed on nodeport 30080.
    Note: You can read the Bitnami documentation for more.
    https://github.com/bitnami/charts/tree/master/bitnami/apache/#installing-the-chart

    
    
    Install the apache from the downloaded helm package (Êâø‰∏ä‰∏ÄÈ°åÁ¨¨5È°å‰∏ãËºâÁöÑapache).
    Release name: mywebapp-nginx

    Note: Do make changes accordingly so that 2 replicas of the webserver are running and the http is exposed on nodeport 30080.
    Make sure that the pods are in the running state.
    
    Hint: Edit the values.yaml file and change the parameters to replicaCount: 2 and http: 30080 under the nodePorts section. Then run helm install command to install the package.

    (ÁõÆÂâçÂè™Êúâ‰∏ÄÂÄãpod)
    controlplane ~ ‚ûú  k get pods
    NAME                              READY   STATUS    RESTARTS   AGE
    mywebapp-nginx-apache-67fdc655c-jljxd   1/1     Running   0          3m1s


    ÂÖà‰øÆÊîπvalues.yaml: (Ë´ãÂÖàÈÄ≤ÂÖ•Âà∞apacheË≥áÊñôÂ§æ‰∏ã)
    controlplane ~ ‚ûú  ls
    apache

    controlplane ~ ‚ûú  cat apache/
    Chart.lock          files/              templates/          
    charts/             .helmignore         values.schema.json  
    Chart.yaml          README.md           values.yaml         

    controlplane ~ ‚úñ vim apache/values.yaml 
    ...
    replicaCount: 2 #1  ‰øÆÊîπreplicaCountÁÇ∫2
    ...
    nodePorts:
    http: "30080" # Ê≠§Ê¨ÑË®≠ÁΩÆÁÇ∫30080
    ...

    ÂÜçinstall apache package:
    Once you have modified the values.yaml file , run the below command to install the apache package on the controlplane node:

    controlplane ~ ‚ûú  helm install mywebapp-nginx ./apache
    NAME: mywebapp-nginx
    LAST DEPLOYED: Tue Feb 18 22:11:39 2025
    NAMESPACE: default
    STATUS: deployed
    REVISION: 1
    TEST SUITE: None
    NOTES:
    CHART NAME: apache
    CHART VERSION: 11.3.2
    APP VERSION: 2.4.63
    ....

    (ÁúãÂà∞ÊúâÂÖ©ÂÄãpodÈÅãË°å‰∏≠)
    controlplane ~ ‚ûú  k get pods
    NAME                              READY   STATUS    RESTARTS   AGE
    mywebapp-nginx-apache-67fdc655c-9g6s6   0/1     Running   0          18s
    mywebapp-nginx-apache-67fdc655c-zlmn6   0/1     Running   0          18s

    Verfiy: helm list

    controlplane ~ ‚ûú  helm list
    NAME            NAMESPACE       REVISION        UPDATED                                 STATUS          CHART            APP VERSION
    **mywebapp-nginx**     default         1             2025-02-18 22:11:39.284356127 +0000 UTC deployed        apache-11.3.2    2.4.63    


    You can access the Apache default page by clicking on mywebapp-nginx link from the top of the terminal.
    ![Successfully access Apache](images/helm.png "Successfully access Apache")


### Ë™çË≠òHelm Chart 
Template‰∏≠ Deployment.yaml ÈÖçÁΩÆÊñá‰ª∂‰∏≠value ÂèäValues.yaml ‰πãÈñìÁöÑÈóú‰øÇ:
![Helm Values](images/Helm-Chart%20&%20Values.png "Helm Values")

Chart.yaml‰∏≠ÁöÑproperties:
![Helm Chart](images/Helm-Chart.png "Helm Chart")

Helm ÁöÑÊñá‰ª∂ÁµêÊßã:
![Helm File Structure](images/Helm-Chart%20structure.png "Helm File Structure")

Âú®command line‰∏≠‰ΩøÁî® helm --set Ë®≠ÁΩÆTemplate-Deployment.yaml‰∏≠ÁöÑvalueÁÇ∫Ëá™Ë®ÇÁöÑÂÄº (ËÄåÈùûValues.yaml‰∏≠È†êË®≠ÁöÑÂÄº):
![Helm Custom Values](images/Helm-Custom-values01.png "Helm Custom Values")

Install ChartÊôÇ‰ΩøÁî® helm --valueÊåáÂÆöÂÆâË£ùchartÁöÑÊôÇÂÄôÔºåËÆÄÂèñËá™Ë®ÇÁöÑcustome value fileÊñá‰ª∂:
![Helm Install Custom Values](images/Helm%20Install%20custom%20value.png "Helm Install Custom Values")

‰ΩøÁî®--untarÂèÉÊï∏‰æÜ‰∏ãËºâ‰∏¶Ëß£Â£ìÁ∏Æ Chart (ËÄåÈùû‰∏ãËºâChart‰∏¶ÂÑ≤Â≠òÁÇ∫‰∏ÄÂÄã .tgz ÁöÑÂ£ìÁ∏ÆÊ™îÊ°à) :
![Helm Pull untar](images/Helm%20Pull%20untar.png "Helm Pull untar")


‰ªÄÈ∫ºÊòØChart??
The helm package that contains all of the resource definitions necessary to run an application, tool, or service inside of a Kubernetes cluster is known as a Chart.

We cannot install the same chart multiple times on the same Kubernetes Cluster.
False

Which command is used to search for a wordpress helm chart package from the Artifact Hub?
option1: helm search wordpress
option2: helm search hub wordpress
Answer: option2

Search for a consul helm chart package from the Artifact Hub and identify the APP VERSION for the Official HashiCorp Consul Chart.

controlplane ~ ‚ûú  helm search hub consul |grep Official
https://artifacthub.io/packages/helm/warjiang/c...      1.3.0           1.17.0          Official HashiCorp Consul Chart                   
https://artifacthub.io/packages/helm/hashicorp/...      1.6.2           1.20.2          Official HashiCorp Consul Chart                   
https://artifacthub.io/packages/helm/wener/consul       1.6.2           1.20.2          Official HashiCorp Consul Chart                   
https://artifacthub.io/packages/helm/wenerme/co...      1.6.2           1.20.2          Official HashiCorp Consul Chart                   

controlplane ~ ‚ûú  helm search hub consul |grep hashicorp
https://artifacthub.io/packages/helm/hashicorp/...      1.6.2           1.20.2          Official HashiCorp Consul Chart                   

Answer: 1.20.2


Add bitnami helm chart repository in the controlplane node.
The url for bitnami repository is https://charts.bitnami.com/bitnami

controlplane ~ ‚ûú  helm repo add -h
add a chart repository

Usage:
  helm repo add [NAME] [URL] [flags]

...

controlplane ~ ‚ûú  helm repo add bitnami https://charts.bitnami.com/bitnami
"bitnami" has been added to your repositories

controlplane ~ ‚ûú  helm repo list
NAME    URL                               
bitnami https://charts.bitnami.com/bitnami

controlplane ~ ‚ûú  helm search repo wordpress
NAME                    CHART VERSION   APP VERSION     DESCRIPTION                                       
bitnami/wordpress       24.1.18         6.7.2           WordPress is the world's most popular blogging ...
bitnami/wordpress-intel 2.1.31          6.1.1           DEPRECATED WordPress for Intel is the most popu...


How many helm chart repositories are there in the controlplane node now?
We have added a few helm chart repositories in the controlplane node now.

controlplane ~ ‚ûú  helm repo list
NAME            URL                                                 
bitnami         https://charts.bitnami.com/bitnami                  
puppet          https://puppetlabs.github.io/puppetserver-helm-chart
hashicorp       https://helm.releases.hashicorp.com    

Answer: 3 Charts


Deploy the Apache application on the cluster using the apache from the bitnami repository.
Set the release Name to: amaze-surf

controlplane ~ ‚ûú  helm install amaze-surf bitnami/apache
Pulled: us-central1-docker.pkg.dev/kk-lab-prod/helm-charts/bitnami/apache:11.3.2
Digest: sha256:1bd45c97bb7a0000534e3abc5797143661e34ea7165aa33068853c567e6df9f2
NAME: amaze-surf
LAST DEPLOYED: Fri Mar  7 19:20:08 2025
NAMESPACE: default
STATUS: deployed
REVISION: 1
TEST SUITE: None
NOTES:
CHART NAME: apache
CHART VERSION: 11.3.2
APP VERSION: 2.4.63
...


What version of apache did we just install on the cluster using the helm chart?

controlplane ~ ‚ûú  helm list
NAME            NAMESPACE       REVISION        UPDATED                                 STATUS          CHART            APP VERSION
amaze-surf      default         1               2025-03-07 19:20:08.629425345 +0000 UTC deployed        apache-11.3.2    2.4.63     

Answer: 2.4.63


How many releases of nginx charts can you see installed in the cluster now?
Note: We just installed some charts

controlplane ~ ‚ûú  helm list
NAME            NAMESPACE       REVISION        UPDATED                                 STATUS          CHART         APP VERSION
amaze-surf      default         1               2025-03-07 19:20:08.629425345 +0000 UTC deployed        apache-11.3.2 2.4.63     
crazy-web       default         1               2025-03-07 19:21:33.217962104 +0000 UTC deployed        nginx-19.0.0  1.27.4     
happy-browse    default         1               2025-03-07 19:21:31.886173725 +0000 UTC deployed        nginx-19.0.0  1.27.4     

Answer: 2 Charts


Uninstall the nginx chart release happy-browse from the cluster.

controlplane ~ ‚ûú  helm list | grep nginx
crazy-web       default         1               2025-03-07 19:21:33.217962104 +0000 UTC deployed        nginx-19.0.0  1.27.4     
happy-browse    default         1               2025-03-07 19:21:31.886173725 +0000 UTC deployed        nginx-19.0.0  1.27.4     

...
Usage:
  helm uninstall RELEASE_NAME [...] [flags]

Aliases:
  uninstall, del, delete, un
...

controlplane ~ ‚ûú  helm uninstall happy-browse
release "happy-browse" uninstalled


Remove the Hashicorp helm repository from the cluster.

controlplane ~ ‚ûú  helm repo list
NAME            URL                                                 
bitnami         https://charts.bitnami.com/bitnami                  
puppet          https://puppetlabs.github.io/puppetserver-helm-chart
hashicorp       https://helm.releases.hashicorp.com                 

controlplane ~ ‚ûú  helm repo -h
...
Usage:
  helm repo [command]

Available Commands:
  add         add a chart repository
  index       generate an index file given a directory containing packaged charts
  list        list chart repositories
  remove      remove one or more chart repositories
  update      update information of available charts locally from chart repositories

...



controlplane ~ ‚ûú  helm repo remove hashicorp
"hashicorp" has been removed from your repositories

Add bitnami helm chart repository to the cluster.
Note: - Make sure to add the bitnami chart to the cluster before moving to the next questions.

controlplane ~ ‚ûú  helm repo add bitnami
Error: "helm repo add" requires 2 arguments

Usage:  helm repo add [NAME] [URL] [flags]

controlplane ~ ‚úñ helm repo add bitnami https://charts.bitnami.com/bitnami
"bitnami" has been added to your repositories

controlplane ~ ‚ûú  helm repo list
NAME    URL                               
bitnami https://charts.bitnami.com/bitnami


How many **releases** of nginx can you see in the cluster now?
controlplane ~ ‚ûú  helm list
NAME            NAMESPACE       REVISION        UPDATED                                 STATUS       CHART           APP VERSION
dazzling-web    default         3               2025-03-07 19:37:09.981878212 +0000 UTC deployed     nginx-12.0.4    1.22.0     

Answer: 1 release


How many **revisions** of nginx exists in the cluster?
Hint: helm history <release-name>

controlplane ~ ‚ûú  helm list
NAME              NAMESPACE       REVISION        UPDATED                                 STATUS       CHART           APP VERSION
**dazzling-web**    default         3               2025-03-07 19:37:09.981878212 +0000 UTC deployed     nginx-12.0.4    1.22.0     


controlplane ~ ‚úñ helm history **dazzling-web**
REVISION        UPDATED                         STATUS          CHART           APP VERSION     DESCRIPTION     
1               Fri Mar  7 19:37:07 2025        superseded      nginx-12.0.4    1.22.0          Install complete
2               Fri Mar  7 19:37:08 2025        superseded      nginx-12.0.5    1.22.0          Upgrade complete
3               Fri Mar  7 19:37:09 2025        deployed        nginx-12.0.4    1.22.0          Upgrade complete


Answer: 3 Revisions


Which version of nginx is currently running in the cluster?

(Êâø‰∏äÈ°å)
controlplane ~ ‚ûú  helm list
NAME            NAMESPACE       REVISION        UPDATED                                 STATUS       CHART           APP VERSION
dazzling-web    default         3               2025-03-07 19:37:09.981878212 +0000 UTC deployed     nginx-12.0.4    1.22.0     

Answer: 1.22.0


### Helm Upgrade & Rollback
The DevOps team has decided to upgrade the nginx version to 1.27.x and use the Helm chart version 18.3.6 from the Bitnami repository.

Ensure that the nginx version running in the cluster is 1.27.x.

Hint: You can use the helm upgrade command.

**ÂÖàÊü•ÁúãÁï∂Ââçningx podÁöÑImage version**:
controlplane ~ ‚ûú  k get pods
NAME                                  READY   STATUS    RESTARTS   AGE
dazzling-web-nginx-65fd75c87f-4vwc7   1/1     Running   0          4m45s


controlplane ~ ‚ûú  k describe pod dazzling-web-nginx-65fd75c87f-4vwc7 |grep Image:
    Image:          docker.io/bitnami/nginx:1.22.0-debian-11-r3


**Âü∑Ë°åupgradeÂâçÔºåÂÖàhelm search repo Ê™¢Êü• bitnami/nginx ÊòØÂê¶ÂèØÁî®**:

controlplane ~ ‚ûú  helm repo list
NAME    URL                               
bitnami https://charts.bitnami.com/bitnami

controlplane ~ ‚ûú  helm search repo bitnami/nginx (ÈÄôÂÄãÂ¶ÇÊûúÊêú‰∏çÂà∞ÔºåÂâá‰ΩøÁî®grep nginx)
No results found

controlplane ~ ‚ûú  helm search repo bitnami |grep nginx
bitnami/nginx                                   19.0.1          1.27.4          NGINX Open Source is a web server that can be a...
bitnami/nginx-ingress-controller                11.6.11         1.12.0          NGINX Ingress Controller is an Ingress controll...
bitnami/nginx-intel                             2.1.15          0.4.9           DEPRECATED NGINX Open Source for Intel is a lig...

bitnami repo Â∑≤Á∂ìÊ∑ªÂä†Âà∞Êú¨Âú∞ÁöÑ Helm repo ÂàóË°®‰∏≠ÔºåÂâáÂèØÂü∑Ë°åupgrade


**Âü∑Ë°åupgrade**:
controlplane ~ ‚ûú  helm upgrade -h
...
Usage:
  helm upgrade [RELEASE] [CHART] [flags]
...

controlplane ~ ‚ûú  helm upgrade dazzling-web **bitnami/nginx** **--version 18.3.6**
Pulled: us-central1-docker.pkg.dev/kk-lab-prod/helm-charts/bitnami/nginx:18.3.6
Digest: sha256:19a3e4578765369a8c361efd98fe167cc4e4d7f8b4ee42da899ae86e5f2be263
Release "dazzling-web" has been upgraded. Happy Helming!
NAME: dazzling-web
LAST DEPLOYED: Fri Mar  7 19:48:20 2025
NAMESPACE: default
STATUS: deployed
REVISION: 4
TEST SUITE: None
NOTES:
CHART NAME: nginx
CHART VERSION: 18.3.6
APP VERSION: 1.27.4

**Ê™¢Êü•nginx pod ÊòØÂê¶Â∑≤Êõ¥Êñ∞Image version**:

controlplane ~ ‚ûú  helm list
NAME            NAMESPACE       REVISION        UPDATED                                 STATUS          CHART            APP VERSION
dazzling-web    default         4               2025-03-07 19:48:20.045990817 +0000 UTC deployed        nginx-18.3.6     1.27.4     


controlplane ~ ‚ûú  k get pods
NAME                                 READY   STATUS    RESTARTS   AGE
dazzling-web-nginx-f759468b5-2hkzg   1/1     Running   0          8m27s

controlplane ~ ‚ûú  k describe pod dazzling-web-nginx-f759468b5-2hkzg |grep Image:
    Image:           docker.io/bitnami/nginx:1.27.4-debian-12-r0
    Image:           docker.io/bitnami/nginx:1.27.4-debian-12-r0


To which version is the nginx currently upgraded?
(Êâø‰∏äÈ°å)

controlplane ~ ‚ûú  helm list
NAME            NAMESPACE       REVISION        UPDATED                                 STATUS          CHART            APP VERSION
dazzling-web    default         4               2025-03-07 19:48:20.045990817 +0000 UTC deployed        nginx-18.3.6     1.27.4     

Answer: 1.27.4



Oops!.. There seems to be a minor issue in the website and the DevOps Team is asked to rollback the nginx to previous version!

Please rollback the nginx to previous version.

controlplane ~ ‚ûú  helm rollback -h
...

Usage:
  helm rollback <RELEASE> [REVISION] [flags]

...

controlplane ~ ‚úñ helm history dazzling-web
REVISION        UPDATED                         STATUS          CHART           APP VERSION     DESCRIPTION     
1               Fri Mar  7 19:37:07 2025        superseded      nginx-12.0.4    1.22.0          Install complete
2               Fri Mar  7 19:37:08 2025        superseded      nginx-12.0.5    1.22.0          Upgrade complete
3               Fri Mar  7 19:37:09 2025        superseded      nginx-12.0.4    1.22.0          Upgrade complete
4               Fri Mar  7 19:48:20 2025        deployed        nginx-18.3.6    1.27.4          Upgrade complete

controlplane ~ ‚ûú  helm rollback dazzling-web 3
Rollback was a success! Happy Helming!

controlplane ~ ‚ûú  helm history dazzling-web
REVISION        UPDATED                         STATUS          CHART           APP VERSION     DESCRIPTION     
1               Fri Mar  7 19:37:07 2025        superseded      nginx-12.0.4    1.22.0          Install complete
2               Fri Mar  7 19:37:08 2025        superseded      nginx-12.0.5    1.22.0          Upgrade complete
3               Fri Mar  7 19:37:09 2025        superseded      nginx-12.0.4    1.22.0          Upgrade complete
4               Fri Mar  7 19:48:20 2025        superseded      nginx-18.3.6    1.27.4          Upgrade complete
5               Fri Mar  7 20:00:43 2025        deployed        nginx-12.0.4    1.22.0          Rollback to 3   


### Manually Create Helm Template 

helm create Âª∫Á´ãhelm template:
![Helm Create Helm Template](images/Helm-Write%20chart.png "Helm Create Helm Template")

helm install Ë®≠ÁΩÆËá™Ë®ÇÂÄºÔºåÂèØ‰ΩøÁî®--set ÊàñÊòØÁõ¥Êé•ÂÆöÁæ©Êñºvalues.yamlÊñá‰ª∂:
![Helm Write 2 ways](images/Helm%20install%202%20ways.png "Helm Write 2 ways")

Ê≥®ÊÑèvalues.yaml ÂÖßÁöÑobjectÂ§ßÂ∞èÂØ´ÂçÄÂà•! :
![Helm Objects](images/Helm-Object.png "Helm Objects")

values.yaml Êí∞ÂØ´ÁØÑ‰æã :
![Helm Values Dictionary](images/Helm%20values%20dictionary.png "Helm Values Dictioinary")

‰ΩøÁî®helm lintÊåá‰ª§Ê™¢Êü•templateÊòØÂê¶Ë®≠ÁΩÆÊ≠£Á¢∫:
![Helm Lint](images/Helm%20lint.png "Helm Lint")

ÂÄòËã•‰ΩøÁî®helm lintÁÑ°Ê≥ïÊü•ÁúãÂá∫ÂïèÈ°å(ÂÉèÊòØÊúâ‰∫õÂïèÈ°åÊòØkubernetesÂ∞éËá¥ÁöÑÂïèÈ°åËÄåÈùûTemplateË®≠ÁΩÆÈåØË™§)ÔºåÂâáÊ∑ªÂä†--dry-runÊåá‰ª§‰æÜÊü•ÁúãÁ¥∞ÈÉ®ÂïèÈ°å:
![Helm with --dry-run command](images/helm%20dry-run.png "Helm with --dry-run command")


We have pulled a hello-world chart in the directory /root.
Please explore the chart and move to the next question.

controlplane ~ ‚ûú  ls
hello-world


Inspect the apiVersion set on this chart and identify what Helm version this chart was built for.

controlplane ~ ‚ûú  cat hello-world/
Chart.yaml   .helmignore  README.md    templates/   values.yaml  

controlplane ~ ‚ûú  cat hello-world/Chart.yaml
apiVersion: v2
appVersion: 1.16.0
description: A Helm chart for Kubernetes
Name: hello-world
type: application
version: 0.1.0


Answer: helm v3

(Ê≥®ÊÑè! apiVersion: v2 -> Ê≠§ÁÇ∫helm v3 ; apiVersion: v1 -> Ê≠§ÁÇ∫helm v2!)


What would be the name of the container created by this helm chart called hello-world?
Answer the question by exploring the chart files. Do not deploy a release using the chart yet.

controlplane ~ ‚ûú  cat hello-world/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: {{ .Release.Name }}-hello-world
  labels:
    app: hello-world
spec:
  replicas: {{ .Values.replicaCount }}
  selector:
    matchLabels:
      app: hello-world
  template:
    metadata:
      labels:
        app: hello-world
    spec:
      containers:
        - **name: {{ .Chart.Name }}**
          image: "{{ .Values.image.repository }}:{{ .Values.image.tag }}"
          imagePullPolicy: {{ .Values.image.pullPolicy }}
          ports:
            - name: http
              containerPort: 80
              protocol: TCP
          livenessProbe:
            httpGet:
              path: /
              port: http
          readinessProbe:
            httpGet:
              path: /
              port: http

controlplane ~ ‚úñ cat hello-world/Chart.yaml
apiVersion: v2
appVersion: 1.16.0
description: A Helm chart for Kubernetes
Name: hello-world
type: application
version: 0.1.0

ÊâÄ‰ª•: {{ .Chart.Name }} -> Â∞±ÊòØhello-world

Answer: hello-world



What would be the name of the image used by the container created by this helm chart called hello-world?
Answer the question by exploring the chart files. Do not deploy a release using the chart yet.

controlplane ~ ‚ûú  cat hello-world/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: {{ .Release.Name }}-hello-world
  labels:
    app: hello-world
spec:
  replicas: {{ .Values.replicaCount }}
  selector:
    matchLabels:
      app: hello-world
  template:
    metadata:
      labels:
        app: hello-world
    spec:
      containers:
        - name: {{ .Chart.Name }}
          **image: "{{ .Values.image.repository }}:{{ .Values.image.tag }}"**
          imagePullPolicy: {{ .Values.image.pullPolicy }}
          ports:
            - name: http
              containerPort: 80
              protocol: TCP
          livenessProbe:
            httpGet:
              path: /
              port: http
          readinessProbe:
            httpGet:
              path: /
              port: http


controlplane ~ ‚ûú  cat hello-world/values.yaml 
/# Default values for hello-world.
/# This is a YAML-formatted file.
/# Declare variables to be passed into your templates.

replicaCount: 1

image:
  repository: nginx
  pullPolicy: IfNotPresent
  /# Overrides the image tag whose default is the chart appVersion.
  tag: "1.16.0"

nameOverride: ""
fullnameOverride: ""

service:
  type: ClusterIP
  port: 80

ÊâÄ‰ª•:
{{ .Values.image.repository }}: nginx
{{ .Values.image.tag }}: 1.16.0

Answer: nginx: 1.16.0



Navigate to the directory /root/webapp-nginx where we have a deployment and service definition files of an app.
Explore the files and move to the next question.

controlplane ~/webapp-nginx ‚ûú  ls
deployment.yaml  service.yaml

What resources are created as part of this application?
Answer: Deployment & Service


What would be the name of the deployment if we were to deploy this application on the cluster now?
controlplane ~ ‚ûú  cat webapp-nginx/deployment.yaml 
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx
spec:
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
        - name: nginx
          image: "nginx:1.16.0"
          imagePullPolicy: IfNotPresent
          ports:
            - name: http
              containerPort: 80
              protocol: TCP

Answer: nginx



Create a helm chart at /root/webapp-nginx-nginx for this application by converting the deployment and service definition files into templates.
Create a chart first and then move the definition files into the templates directory.
The deployment and service objects should be named in the format RELEASE-NAME-nginx.
Set apiVersion for the chart to v2.
Name the chart webapp-nginx-nginx.
Set version number to 0.1.1.
Set appVersion to 1.16.0.
Values file has a variable image set by default so make changes for an image nginx:1.16.0.
Value of image variable to be used in deployment as the image name for the container.
Note: - Remove the unused YAML and text files from the templates directory.

controlplane ~ ‚ûú  mv webapp/ webapp-nginx

controlplane ~ ‚ûú  ls
hello-world  webapp-nginx

controlplane ~ ‚ûú  cd webapp-nginx-nginx/

controlplane ~/webapp-nginx-nginx ‚ûú  helm create .
Creating .

controlplane ~/webapp-nginx-nginx is üì¶ v0.1.0 via ‚éà v3.17.1 ‚ûú  ls
charts  Chart.yaml  deployment.yaml  service.yaml  templates  values.yaml

controlplane ~/webapp-nginx is üì¶ v0.1.0 via ‚éà v3.17.1 ‚ûú  rm templates/deployment.yaml

controlplane ~/webapp-nginx is üì¶ v0.1.0 via ‚éà v3.17.1 ‚ûú  rm templates/service.yaml 

Âü∑Ë°å: then move the definition files into the templates directory
controlplane ~/webapp-nginx is üì¶ v0.1.0 via ‚éà v3.17.1 ‚ûú  mv deployment.yaml templates/

controlplane ~/webapp-nginx is üì¶ v0.1.0 via ‚éà v3.17.1 ‚ûú  mv service.yaml templates/

controlplane ~/webapp-nginx is üì¶ v0.1.0 via ‚éà v3.17.1 ‚ûú  ls templates/
deployment.yaml  hpa.yaml      NOTES.txt            service.yaml
_helpers.tpl     ingress.yaml  serviceaccount.yaml  tests

Âü∑Ë°å: Note: - Remove the unused YAML and text files from the templates directory.

controlplane ~/webapp-nginx is üì¶ v0.1.1 via ‚éà v3.17.1 ‚úñ rm templates/hpa.yaml 

controlplane ~/webapp-nginx is üì¶ v0.1.1 via ‚éà v3.17.1 ‚ûú  rm templates/ingress.yaml templates/_helpers.tpl  templates/ingress.yaml 

controlplane ~/webapp-nginx is üì¶ v0.1.1 via ‚éà v3.17.1 ‚úñ ls templates/
deployment.yaml  NOTES.txt  serviceaccount.yaml  service.yaml  tests

controlplane ~/webapp-nginx is üì¶ v0.1.1 via ‚éà v3.17.1 ‚ûú  rm templates/NOTES.txt templates/serviceaccount.yaml 

controlplane ~/webapp-nginx is üì¶ v0.1.1 via ‚éà v3.17.1 ‚ûú  ls templates/
deployment.yaml  service.yaml  tests

controlplane ~/webapp-nginx is üì¶ v0.1.1 via ‚éà v3.17.1 ‚ûú  rm -rf templates/tests/

controlplane ~/webapp-nginx is üì¶ v0.1.1 via ‚éà v3.17.1 ‚ûú  ls templates/
deployment.yaml  service.yaml


‰øÆÊîπChart.yaml:
controlplane ~/webapp-nginx is üì¶ v0.1.1 via ‚éà v3.17.1 ‚ûú  vim Chart.yaml 
apiVersion: v2 # Checked
name: webapp-nginx-nginx # Changed
description: A Helm chart for Kubernetes

type: application

version: 0.1.1 # Changed

appVersion: "1.16.0" # Checked

‰øÆÊîπvalues.yaml:

""Values file has a variable image set by default so make changes for an image nginx:1.16.0. -> ÊâÄ‰ª• repositoryÁÇ∫nginx, tagÁÇ∫1.16.0""

image:
  **repository: nginx:1.16.0** #nginx # Changed
  pullPolicy: IfNotPresent
  **tag: 1.16.0**  #"" # Changed


‰øÆÊîπdeployment.yaml:

controlplane ~/webapp-nginx is üì¶ v0.1.1 via ‚éà v3.17.1 ‚ûú  vim templates/deployment.yaml 
apiVersion: apps/v1
kind: Deployment
metadata:
  name: **{{ .Release.Name }}-nginx**  #nginx
spec:
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
        - name: **{{ .Values.image.repository }**} #nginx
          image: **{{ .Values.image.repository }}:{{ .Values.image.tag }}** #"nginx:1.16.0"
          imagePullPolicy: IfNotPresent
          ports:
            - name: http
              containerPort: 80
              protocol: TCP
                             

‰øÆÊîπService.yaml:

controlplane ~/webapp-nginx is üì¶ v0.1.1 via ‚éà v3.17.1 ‚ûú  vim templates/service.yaml 
apiVersion: v1
kind: Service
metadata:
  name: **{{ .Release.Name}}-nginx** #nginx
spec:
  type: NodePort
  ports:
    - port: 80
      targetPort: http
      protocol: TCP
      nodePort: 30080
      name: http
  selector:
    app: nginx


DeploymentË∑üService‰∏≠metadataÁöÑname, Ë´ãËá≥helm ÂÆòÁ∂≤ÊêúÂ∞ã: built-in Objects!
https://helm.sh/docs/chart_template_guide/builtin_objects/#helm
ÈÄèÈÅéÊü•Ë©¢‰æøÂèØÂæóÁü•Ë¶Å‰ΩøÁî®.Release.NameÈÄôÂÄãÂÖßÂª∫ËÆäÊï∏


ÈÄèÈÅélint Ê™¢Êü•ChartÊòØÂê¶Ë®≠ÁΩÆÊ≠£Á¢∫:
controlplane ~/webapp-nginx is üì¶ v0.1.1 via ‚éà v3.17.1 ‚ûú  cd ..

controlplane ~ ‚ûú  helm lint webapp-nginx/
==> Linting webapp-nginx/
[INFO] Chart.yaml: icon is recommended

1 chart(s) linted, 0 chart(s) failed



What would be the nodePort at which the service exposes the application if we deploy a release with this helm chart - webapp?

controlplane ~ ‚ûú  cat webapp-nginx/templates/service.yaml 
apiVersion: v1
kind: Service
metadata:
  name: {{ .Release.Name }}-nginx
spec:
  type: NodePort
  ports:
    - port: 80
      targetPort: http
      protocol: TCP
      nodePort: 30080
      name: http
  selector:
    app: nginx

Ansewer: 30080



There seems to be an issue with the service.yaml.
Identify the issue and fix it.
Note: We have made some changes.

(ÈÄôÊòØÂéüÊú¨Ë®≠ÁΩÆÁöÑ)
controlplane ~ ‚ûú  cat webapp-nginx/templates/service.yaml 
apiVersion: v1
kind: Service
metadata:
  name: {{ .Release.Name }}-nginx
spec:
  type: NodePort
  ports:
    - port: 80
      targetPort: http
      protocol: TCP
      nodePort: 30080
      name: http
  selector:
    app: nginx

(‰ª•‰∏ãÊòØÈ°åÁõÆËÆäÊõ¥ÁöÑÔºåÈúÄË¶Å‰øÆÊîπ)
controlplane ~ ‚ûú  cat webapp-nginx/templates/service.yaml 
apiVersion: v1
kind: Service
metadata:
  name: {{ .Release.Name }}-nginx
spec:
  type: NodePort
  ports:
    - port: 80
      targetPort: http
      protocol: TCP
      nodePort: {{ .Values.service.NodePort }}
      name: http
  selector:
    app: nginx

(Ê≠§ËôïÁôºÁèæÊú™‰øÆÊîπÂâçÁî®lintÊ™¢Êü•Ôºå‰∏¶ÁÑ°Â†±ÈåØ! Âè™ËÉΩËÇâÁúºÊ™¢Êü•)
controlplane ~/webapp-nginx is üì¶ v0.1.1 via ‚éà v3.17.1 ‚ûú  helm lint .
==> Linting .
[INFO] Chart.yaml: icon is recommended

1 chart(s) linted, 0 chart(s) failed


‰øÆÊîπ:
controlplane ~/webapp-nginx is üì¶ v0.1.1 via ‚éà v3.17.1 ‚ûú  vim templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: {{ .Release.Name }}-nginx
spec:
  type: NodePort
  ports:
    - port: 80
      targetPort: http
      protocol: TCP
      nodePort: {{ .Values.service.nodePort }}
      #nodePort: {{ .Values.service.NodePort }}
      name: http
  selector:
    app: nginx


Now change the service type in the service.yaml so as to fetch value from the values.yaml.

controlplane ~/webapp-nginx is üì¶ v0.1.1 via ‚éà v3.17.1 ‚ûú  vim templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: {{ .Release.Name }}-nginx
spec:
  type: {{ .Values.service.type }} # Add
  #type: NodePort
  ports:
    - port: 80
      targetPort: http
      protocol: TCP
      nodePort: {{ .Values.service.nodePort }}
        #nodePort: {{ .Values.service.NodePort }}
      name: http
  selector:
    app: nginx
              


Now install the webapp-nginx helm chart.
Release-Name:webapp

You will be able to view the application by accessing the webapp icon located at the top right corner of the terminal.

controlplane ~/webapp-nginx is üì¶ v0.1.1 via ‚éà v3.17.1 ‚ûú  cd ..

controlplane ~ ‚ûú  helm install webapp ./webapp-nginx/
NAME: webapp
LAST DEPLOYED: Fri Mar  7 23:49:56 2025
NAMESPACE: default
STATUS: deployed
REVISION: 1
TEST SUITE: None

controlplane ~ ‚ûú  helm list
NAME    NAMESPACE       REVISION        UPDATED                                 STATUS      CHART                    APP VERSION
webapp  default         1               2025-03-07 23:49:56.915586208 +0000 UTC deployed    webapp-nginx-0.1.1       1.16.0     


k get svc, deployÊ™¢Êü•

controlplane ~ ‚ûú  k get deploy,svc
NAME                           READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/webapp-nginx   1/1     1            1           64s # Added

NAME                   TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)        AGE
service/kubernetes     ClusterIP   172.20.0.1     <none>        443/TCP        59m
service/webapp-nginx   NodePort    172.20.208.1   <none>        80:30080/TCP   64s  # Added


### Helm Upload Chart

Which command packages a chart into a versioned chart archive file?
option1: helm package
option2: helm template

Answer: option1

Which command packages a chart into a versioned chart archive file?
Answer: --sign

Which files provide cryptographic verification that a chart has not been
tampered with, and was packaged by a trusted provider?
option1: Provenance
option2: Chart
option3: Archive

Answer option1

Which command can be used to check that the given chart has a valid provenance file?
Answer: helm verify

We have added the webapp-color chart in the /root/ directory.
Package the chart in the /root/package directory.

controlplane ~ ‚ûú  mkdir /root/package

controlplane ~ ‚ûú  cd /root/package/

controlplane ~/package ‚ûú  helm package /root/webapp-color
Successfully packaged chart and saved it to: /root/package/webapp-color-0.1.0.tgz

controlplane ~/package ‚ûú  ls
webapp-color-0.1.0.tgz





